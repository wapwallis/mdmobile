var startpage="welcome";var weather="c";var destination;var destination_id;var cdnurl2="http://cdnstatic-2.mydestination.com/";var apiurl="http://api.mydestination.com/index.cfm/";var cache_timeout=86400;var flight_cache_timeout=130;var json_events="";var json_offers="";var json_categories="";var json_destination="";var json_destinations="";var json_arrivals="";var json_departures="";var getnearest=false;var getnearmenow=false;var getdirections=false;var latitude;var longitude;var dlatitude;var dlongitude;var current_flighttype="departures";var current_airport;var current_airportcode;var IDACC="";var IDREST="";var IDTHING="";var current_category_txt="";var current_category_id="";var current_category_location="";var current_category_type="";var current_category_sort="Default";var current_category_offset=0;var current_category_offset_flag=false;var current_searchstring="";var cdnptr=-1;var cdns=["http://cdnstatic-2.mydestination.com/","http://cdnstatic-3.mydestination.com/","http://cdnstatic-4.mydestination.com/","http://cdnstatic-5.mydestination.com/"];function cdnurl(){cdnptr++;cdnptr=0;return cdns[cdnptr]}function init(){window.scrollTo(0,1);if(showsplash==true){$.mobile.changePage("#splash")}var a=navigator.userAgent.toLowerCase();if(a.search("android 2.2.1")>-1){$.mobile.scrollview.prototype.options.scrollMethod="scroll";$.mobile.defaultPageTransition="none";$.mobile.defaultDialogTransition="none";$.mobile.useFastClick=true}$.mobile.loadingMessage="Initialising...";$.mobile.showPageLoadingMsg();$("#whatson").live("pageshow",function(b){getEvents(false)});$("#offers").live("pageshow",function(b){getOffers(false)});$("#weather").live("pageshow",function(b){getWeather()});$("#flights-sub").live("pageshow",function(b){showDepartures()});$("#destinations-top").live("pagebeforeshow",function(b){getDestinations();$("#div-dsearch .ui-input-text").val("");$("#dsearch-listview").listview("refresh");$("#dsearch-listview").attr("style","display:none");$("#div-destinations-listview").attr("style","display:block")});$("#destinations-sub").live("pagebeforeshow",function(b){$("div#div-search ul").listview("refresh")});$("#filter-location").live("pagebeforeshow",function(b){$("div#div-dfilter ul").listview()});$("#search").live("pagebeforeshow",function(b){$("#ftype").html("Type (All)");$("#flocation").html("Location (All)");$("#fsortby").html("Sort By (Default)");current_category_type="";current_category_location="";current_category_sort="";$("#search .ui-input-text").val("");$("#results .ui-input-text").val("");$("#categories-listview").listview()});$("#welcome_image").attr("src",cdnurl()+"Images/Mobile/welcome/"+Math.floor(Math.random()*9)+".jpg");$("#div-dsearch .ui-input-text").live("keyup",function(){if($("#result:visible").length!=0||$("#div-dsearch .ui-input-text").val()==""){document.getElementById("dsearch-listview").style.display="none";document.getElementById("div-destinations-listview").style.display="block"}else{document.getElementById("dsearch-listview").style.display="block";document.getElementById("div-destinations-listview").style.display="none"}});$("#div-dsearch .ui-input-clear").live("click",function(){document.getElementById("dsearch-listview").style.display="none"});$("#search .ui-input-text").live("keyup",function(b){if(b.keyCode==13){getCategoryId("",false,$("#search .ui-input-text").val())}});$("#search .ui-input-clear").live("click",function(){$("#results .ui-input-text").val("")});$("#results .ui-input-text").live("keyup",function(b){if(b.keyCode==13){getCategoryId("",false,$("#results .ui-input-text").val())}});$("#results .ui-input-clear").live("click",function(){$("#search .ui-input-text").val("")});if(typeof(localStorage)!="undefined"&&localStorage.getItem("weather")!=null){weather=localStorage.getItem("weather")}if(hashid!=""){startpage="home";destination=hashid;getDestination(hashid,"redirect")}else{if(typeof(localStorage)!="undefined"&&localStorage.getItem("destination_id")!=null&&localStorage.getItem("destination")!=null){startpage="home";destination=jQuery.parseJSON(localStorage.getItem("destination"));destination_id=localStorage.getItem("destination_id");updateDestination(destination)}else{if($("#ndestination").html()=="Locate Nearest Destination"){getnearest=true;get_location()}startpage="welcome"}}$("[data-role=page]").live("pageshow",function(d,e){try{if(d.target.id!=""&&d.target.id!="splash"){console.log(destination+"/"+d.target.id);var b=_gat._getTracker("UA-22737678-15");b._trackPageview(destination+"/"+d.target.id)}}catch(c){}});if(showsplash==true){setTimeout("closeSplash()",3000)}else{console.log("ewr");$.mobile.changePage("#"+startpage,{transition:"fade"})}}function get_location(){$.mobile.loadingMessage="locating ...";if(!navigator.geolocation){alert("Error getting your location. Please make sure your GPS is enabled in settings.")}else{navigator.geolocation.getCurrentPosition(get_location_result,function(a){alert("Error getting your location. Please make sure your GPS is enabled in settings. "+a.message)},{enableHighAccuracy:true})}}function get_location_result(a){latitude=a.coords.latitude;longitude=a.coords.longitude;if(getnearmenow==true){get_nearmenow()}if(getnearest==true){getDestination("nearest","")}if(getdirections==true){getDirections()}}function getDestinations(){console.log("getDestinations");if(typeof(localStorage)!="undefined"&&localStorage.getItem("destinations")!=null){json_destinations=jQuery.parseJSON(localStorage.getItem("destinations"))}var a=0;if(json_destinations!=""){a=json_destinations.T}if(gettimestamp()>a+cache_timeout){getAjax(apiurl+"app/destinations.js","getDestinationsCallback")}else{if($("#dsearch-listview").html()==""){updateDestinations(json_destinations)}}}function getDestinationsCallback(a){console.log("getDestinationsCallback");if(typeof(localStorage)!="undefined"){json_destinations=a;localStorage.setItem("destinations",JSON.stringify(a))}updateDestinations(a)}function updateDestinations(a){console.log("updateDestinations");$("#dsearch-listview").empty();$("#destinations-listview li").attr("style","display:none");$.each(a.DEST,function(d,b){var c=d.toLowerCase().replace(/_/g,"-").replace(/ /g,"-");var e="";$.each(b,function(g,f){f.CDNURL=cdnurl();e+=Mustache.to_html($("#template_dsearch").html(),f)});$("#"+c+"-listview").html(e);$("#"+c).attr("style","display:block");$("#dsearch-listview").append(e)});$("#dsearch-listview").listview("refresh");$.mobile.hidePageLoadingMsg()}function get_nearmenow(){getnearmenow=false;$.mobile.changePage("#nearme");$.mobile.loadingMessage="loading near me now";$.mobile.showPageLoadingMsg();var a=apiurl+"app/nearmenow/"+destination_id+".js?lat="+latitude+"&lon="+longitude+"&categoryid=1020";getAjax(a,"getNearmenowCallback")}function getNearmenowCallback(b){json_nearmenow=b;var a="";$.each(b,function(d,c){if(c.ITEMS.length!=0){c.distance=function(){return function(f,e){f=e(f);if(f<1){f=((Math.round(f*100)/100)*1000)+"m"}else{f=(Math.round(f*100)/100)+"km"}return f}};if(c.LABEL=="What's on"){c.CHANGE="";c.THUMBPATH=cdnurl()+destination.toLowerCase().replace(/ /g,"")+"/Events/Photos/";c.FUNCTION="getEvent"}else{if(c.LABEL=="Special Offers"){c.CHANGE="";c.THUMBPATH=cdnurl()+destination.toLowerCase().replace(/ /g,"");c.FUNCTION="getOffer"}else{c.CHANGE="(change)";c.THUMBPATH="";c.FUNCTION="getCompany"}}a+=Mustache.to_html($("#template_companies").html(),c)}});$("#nearmenow").html(a);scrollx();$.mobile.hidePageLoadingMsg()}function getEvents(a){if($("#whatson-listview").html()==""||a==true){$.mobile.loadingMessage="updating events";$.mobile.showPageLoadingMsg();var b=apiurl+"events/"+destination_id+".js";if(a==true){current_category_offset_flag=true;current_category_offset=current_category_offset+10;b+="?offset="+current_category_offset}else{$("#whatson-listview").empty();current_category_offset_flag=false;current_category_offset=0}if(a==false){$("#whatson-listview").empty();$("#whatson-listview-featured").empty();getAjax(b+"?onlyfeatured=true","getEventsFeaturedCallback")}getAjax(b,"getEventsCallback")}else{$("#back-event").attr("href",location.hash);$.mobile.changePage("#whatson")}}function getEventsFeaturedCallback(a){updateEvents(a)}function getEventsCallback(a){updateEvents(a)}function updateEvents(b){json_events=b;$.mobile.changePage("#whatson");var a="";var d="odd";var c=false;c=true;$.each(b,function(h,f){if(f.FEATURED=="0"){c=false}var g=dateFormat(f.DATESTART,"mmmm dS");var j=g;if(f.DATEEND!=""){var e=dateFormat(f.DATEEND,"mmmm dS");if(e!=g){j+=" - "+e}}a+='<li data-theme="m" name="result" class="'+d+'"><a href="javascript:getEvent(\''+f.ID+'\')"><div class="roundedCornersDiv"><img src="'+cdnurl()+destination.toLowerCase().replace(/ /g,"")+"/Events/Photos/"+f.THUMBNAIL+'"></div><h2>'+f.LABEL+"</h2><h3>Type: "+f.TYPELABEL+"</h3><h3>"+j+"</h3><p>"+f.TEXT.substring(0,100)+"...</p></a></li> ";if(d=="odd"){d="even"}else{d="odd"}});if(c==true){if(a!=""){a='<li data-role="list-divider" data-theme="m">Featured Events</li>'+a;$("#whatson-listview-featured").append(a);$("ul#whatson-listview-featured").listview("refresh")}}else{if(current_category_offset_flag==false){a='<li data-role="list-divider" data-theme="m">Upcoming Events</li>'+a}$("#whatson-listview").append(a);$("ul#whatson-listview").listview("refresh");if(b.length==10){$("#whatson_more").removeClass("hidden")}else{$("#whatson_more").addClass("hidden")}}$.mobile.hidePageLoadingMsg()}function getEvent(c){$("#back-event").attr("href",location.hash);var a=false;$.mobile.loadingMessage="loading";$.mobile.showPageLoadingMsg();if(json_events!=""){$.each(json_events,function(e,d){if(d.ID==c){a=true;eventHTML(d);return}})}if(a==false){var b=apiurl+"events/"+destination_id+".js?id="+c;getAjax(b,"getEventCallback")}}function eventHTML(b){var c=dateFormat(b.DATESTART,"mmm dS");var d=c;if(b.DATEEND!=""){var a=dateFormat(b.DATEEND,"mmm dS");if(a!=c){d+=" - "+a}}var e="";e='<div class="eventbar"><h1>'+b.LABEL+'</h1></div><div class="contentbody">';if(b.THUMBNAIL==""||b.THUMBNAIL===undefined){e+='<img src="'+cdnurl()+'Images/DefaultEventLogo.gif">'}else{e+='<img src="'+cdnurl();e+=destination.toLowerCase().replace(/ /g,"")+"/Events/Photos/"+b.THUMBNAIL+'">'}e+='<div class="contentinfo">';if(b.TYPELABEL!=""&&b.TYPELABEL!==undefined){e+="<h2>Type: "+b.TYPELABEL+"</h2>"}if(d!=""){e+="<h2>Date: "+d+"</h2>"}if(b.TIMESTART!=""){e+="<h2>Time: "+b.TIMESTART+"</h2>"}if(b.TELEPHONE!=""){e+='<h2>Tel: <a href="tel:'+b.TELEPHONE+'">'+b.TELEPHONE+"</a></h2>"}e+='</div><br clear="all"></div><div class="contentdetail">';if(b.LABEL!=""){e+="<h2>"+b.LABEL}if(b.LOCATION_1!=""){e+=" at "+b.LOCATION_1}e+="</h2>";if(b.TEXT!=""){e+="<p>"+b.TEXT.replace(/\n/g,"<br>")+"</p>"}e+="</div>";$("#eventbody").html(e);$.mobile.changePage("#event");$.mobile.hidePageLoadingMsg()}function getEventCallback(a){$.each(a,function(c,b){eventHTML(b)})}function getOffers(a){if($("#offers-listview").html()==""||a==true){$.mobile.loadingMessage="updating offers";$.mobile.showPageLoadingMsg();var b=apiurl+"offers/"+destination_id+".js";if(a==true){current_category_offset_flag=true;current_category_offset=current_category_offset+10;b+="?offset="+current_category_offset}else{$("#offers-listview").empty();$("#offers_more").addClass("hidden");current_category_offset_flag=false;current_category_offset=0}getAjax(b,"getOffersCallback")}else{$.mobile.changePage("#offers")}}function getOffersCallback(a){updateOffers(a)}function updateOffers(c){json_offers=c;var b="";var a=new Date();$.mobile.changePage("#offers");var d="odd";if(c.length==0){b='<li data-theme="m" name="result" class="'+d+'"><br><br><h2 class="center">Sorry no results found.</h2><br><br></li>';$("#offers-listview").append(b)}else{$.each(c,function(f,e){e.THUMBNAIL=cdnurl()+destination.toLowerCase().replace(/ /g,"")+e.THUMBNAIL;var g=(Date.parse(e.VALIDTO)-a.getTime())/1000/60/60/24;e.DAYS=Math.round(g*10)/10;if(f%2==0){e.CLASS="odd"}else{e.CLASS="even"}$("#offers-listview").append(Mustache.to_html($("#template_offers").html(),e));if(d=="odd"){d="even"}else{d="odd"}})}$("ul#offers-listview").listview("refresh");if(c.length==10){$("#offers_more").removeClass("hidden")}else{$("#offers_more").addClass("hidden")}$.mobile.hidePageLoadingMsg()}function getOffer(c){var a=false;$.mobile.loadingMessage="loading offer";$.mobile.showPageLoadingMsg();if(json_offers!=""){$.each(json_offers,function(e,d){if(d.ID==c){a=true;d.VALID=d.VALIDFROM+" - "+d.VALIDTO;if(d.RESTRICTIONS==""){d.RESTRICTIONS="None"}offerHTML(d);$("#voucherdetails").html(Mustache.to_html($("#template_offervoucher").html(),d));return}})}if(a==false){var b=apiurl+"offers/"+destination_id+".js?id="+c;getAjax(b,"getOfferCallback")}}function offerHTML(a){var b=a.VALIDFROM+" to "+a.VALIDTO;var c="";c='<div class="offerbar"><h1>Valid: '+b+'</h1></div><div class="contentbody"><img src="'+a.THUMBNAIL+'"><div class="offerinfo">';if(a.MAINCATEGORY!=""){c+="<h2>Type: "+a.MAINCATEGORY+"</h2>"}if(a.TELEPHONE!=""){c+='<h2>Tel: <a href="tel:'+a.TELEPHONE+'">'+a.TELEPHONE+"</a></h2>"}c+='</div><br clear="all"></div>';if(a.LABEL!=""){c+="<h2>"+a.LABEL+"</h2>"}if(a.COMPANYNAME!=""){c+="<p><b>"+a.COMPANYNAME+"</b></p>"}if(a.ADDRESSLINE1!=""){c+="<p>"+a.ADDRESSLINE1+"</p>"}if(a.ADDRESSLINE2!=""){c+="<p>"+a.ADDRESSLINE2+"</p>"}if(a.TEXT!=""){c+="<p><b>Details:</b><br>"+a.TEXT.replace(/\n/g,"<br>")+"</p>"}if(a.RESTRICTIONS!="None"){c+="<p><br><b>Restrictons</b><br>"+a.RESTRICTIONS+"</p>"}$(".offertitle").html(a.LABEL);$("#offerbody").html(c);$.mobile.changePage("#offer");$.mobile.hidePageLoadingMsg()}function getOfferCallback(a){$.each(a,function(c,b){b.VALID=b.VALIDFROM+" - "+b.VALIDTO;if(b.RESTRICTIONS==""){b.RESTRICTIONS="None"}offerHTML(b);$("#voucherdetails").html(Mustache.to_html($("#template_offervoucher").html(),b))})}function getDestination(d,b){if(typeof(localStorage)!="undefined"&&localStorage.getItem(destination!=null)){json_destination=jQuery.parseJSON(localStorage.getItem(name.toLowerCase().replace(/ /g,"")));if(json_destination.ID!=d){json_destination=""}}if(d=="nearest"){getnearest=false;var c=apiurl+"app/destination.js?lat="+latitude+"&lon="+longitude;$.mobile.loadingMessage="locating you ..."}else{$.mobile.loadingMessage="loading travel guide";var c=apiurl+"app/destination.js?id="+d}$.mobile.showPageLoadingMsg();var a=0;if(json_destination!=""){a=json_destination.T}if(gettimestamp()>a+cache_timeout||d=="nearest"||d!=destination_id){getAjax(c,"getDestinationCallback")}else{console.log(json_destination);updateDestination(json_destination)}}function getDestinationCallback(a){if(typeof(localStorage)!="undefined"&&a.NEAREST=="0"){json_destination=a;localStorage.setItem("destination_id",a.ID);localStorage.setItem("destination",JSON.stringify(a))}updateDestination(a)}function updateDestination(d){var b=d.NEAREST;if(b=="1"){$("#ndestination").html("Nearest: "+d.N);$("a:#nearest").attr("href","javascript:getDestination('"+d.ID+"','"+d.N+"')");$("a:#nearest span .ui-icon").removeClass("ui-icon-refresh").addClass("ui-icon-arrow-r")}else{$("#whatson-listview").empty();$("#whatson-listview-featured").empty();$("#offers-listview").empty();$("#results-listview").empty();$("#airports-listview").empty();$("#arrivals-listview").empty();$("#departures-listview").empty();current_category_offset_flag=false;current_category_offset=0;$("#destination").html(d.N);destination=d.N;destination_id=d.ID;d.url=function(){return function(h,g){h=g(h);var f=h.trim().toLowerCase();return cdnurl()+f}};var a=cdnurl()+d.N.replace(/ /g,"").toLowerCase()+"/Pictures/HomePageSlideShow/"+d.P[0].P;$("#destination_image").html('<img src="'+a+'">');var c='<ul id="dfilter-listview" data-theme="m" data-role="listview" data-filter="true" data-inset="false">';c+='<li data-theme="m" data-icon="check" role="heading"><a href="javascript:void(0)" onclick="setfilter(\'location\',\'All\',\'\')">Reset</a></li>';$.each(d.R,function(f,g){if(d.R.length>1){c+='<li data-theme="m" data-icon="arrow-d" role="heading" data-role="list-divider"><a href="javascript:void(0)" onclick="set_filter_location(\''+g.L.toLowerCase().replace(/ /g,"_")+"')\">"+g.L+"</a></li>";$.each(g.R,function(h,i){c+='<li data-theme="m" data-icon="check" name="result" class="filter_location '+g.L.toLowerCase().replace(/ /g,"_")+" "+i.L.toLowerCase().replace(/ /g,"_")+' hidden"><a href="javascript:void(0)" onclick="setfilter(\'location\',\''+i.L+"','')\">&nbsp;&rsaquo;&nbsp;&nbsp;"+i.L+' <span id="count_'+i.L.toLowerCase().replace(/ /g,"_")+'"></span></a></li>'})}else{$.each(g.R,function(h,i){c+='<li data-theme="m" data-icon="check" name="result" class="filter_location '+g.L.toLowerCase().replace(/ /g,"_")+" "+i.L.toLowerCase().replace(/ /g,"_")+'"><a href="javascript:void(0)" onclick="setfilter(\'location\',\''+i.L+"','')\">&nbsp;&rsaquo;&nbsp;&nbsp;"+i.L+' <span id="count_'+i.L.toLowerCase().replace(/ /g,"_")+'"></span></a></li>'})}});c+="</ul>";$("#div-dfilter").html(c);var e="";var c='<ul id="categories-listview" data-theme="m" data-role="listview" data-filter="false" data-inset="false">';$.each(d.CAT,function(g,f){c+='<li data-theme="m" name="result"><a href="javascript:resetCategory(\''+f.ID+"','"+f.LBL+'\', false)" onClick=""><div id="'+f.LBL.toLowerCase().replace(/ /g,"_")+'" class="category_sprites"></div><h1>'+f.LBL+"</h1></a></li>";if(f.LBL=="Accommodation"){IDACC=f.ID}if(f.LBL=="Restaurants"){IDREST=f.ID}if(f.LBL=="Things To Do"||f.LBL=="Activities"){IDTHING=f.ID}if(f.LBL!="Accommodation"&&f.LBL!="Restaurants"&&f.LBL!="Nightlife"&&f.LBL!="Services"&&f.LBL!="Real Estate"&&f.LBL!="Wellness"){if(e!=""){e+=", "}e+=f.LBL}});c+="</ul>";$("#div-categories").html(c);$("#what_button").html('<a id="categories-title" href="#search" data-theme="m" data-role="button" data-icon="arrow-r" data-iconpos="right">e.g. '+e+"</a>");$("#categories-title").button();if(startpage==""){$.mobile.changePage("#home")}}$.mobile.hidePageLoadingMsg()}function set_filter_location(a){if($("."+a).hasClass("hidden")){$(".filter_location").addClass("hidden");$(".filter_location .ui-icon").removeClass("ui-icon-arrow-u").addClass("ui-icon-arrow-d");$("."+a).removeClass("hidden");$("."+a+" .ui-icon").removeClass("ui-icon-arrow-d").addClass("ui-icon-arrow-u")}else{$(".filter_location").addClass("hidden");$(".filter_location .ui-icon").removeClass("ui-icon-arrow-u").addClass("ui-icon-arrow-d")}}function update_filter_location(){$(".filter_location").addClass("hidden")}function getCategories(){$.mobile.loadingMessage="loading";$.mobile.showPageLoadingMsg();var a=apiurl+"categories/"+destination_id+".js";getAjax(a,"getCategoriesCallback")}function getCategoriesCallback(a){if(typeof(localStorage)!="undefined"){localStorage.setItem("categories",JSON.stringify(a))}json_categories=a;updateCategories(a)}function updateCategories(b){$("#tfilter-listview").empty();var a="";$.each(b,function(c,d){a='<li class="tfilter '+d.LABEL.replace(/ /g,"_")+' all" data-icon="check" data-theme="m" role="heading"><a href="javascript:void(0)" onclick="setfilter(\'type\',\'All\',\''+d.ID+"')\">Reset</a></li>";$("#tfilter-listview").append(a);$.each(d.SUBCATEGORIES,function(e,f){a='<li class="tfilter '+d.LABEL.replace(/ /g,"_")+" "+f.ID+'" data-theme="m" data-icon="check" name="result"><a href="javascript:void(0)" onclick="setfilter(\'type\',\''+f.LABEL+"','"+f.ID+"')\">"+f.LABEL+' <span id="count_'+f.ID+'"></span></a></li>';$("#tfilter-listview").append(a)})});$("ul#tfilter-listview").listview("refresh");$.mobile.hidePageLoadingMsg()}function resetCategory(c,a,b){current_category_txt=a;$(".results-title-txt").html(a);getCategoryId(c,b,"")}function getCategoryId(g,c,b){$.mobile.changePage("#results");$.mobile.loadingMessage="loading";$.mobile.showPageLoadingMsg();if($("#tfilter-listview").html()==""){getCategories()}var d=current_category_id;var a=$("#ftype").html().replace("Type (","").replace(")","");if(g!=""){d=g}current_category_id=d;if(b!=""){current_category_txt="Search: '"+b+"'";$(".results-title-txt").html("Search: '"+b+"'");current_searchstring=b;$("#search .ui-input-text").val(b);$("#results .ui-input-text").val(b);var e=apiurl+"app/companies/"+destination_id+".js?noBronze=true&qCoName="+b}else{current_searchstring="";var e=apiurl+"app/companies/"+destination_id+".js?noBronze=true&categoryId="+d}if(current_category_sort!=""){e+="&sortBy="+current_category_sort}var f=current_category_location;if(f!=""&&f!="All"){e+="&areaname="+f}if(c==true){current_category_offset_flag=true;current_category_offset=current_category_offset+10;e+="&offset="+current_category_offset}else{$("#results-listview").empty();$("#results_more").addClass("hidden");current_category_offset_flag=false;current_category_offset=0}getAjax(e,"getCategoryIDCallback")}function getCategoryIDCallback(b){var a="";var d="";var c="odd";if(b.ITEMS.length==0){a+='<li data-theme="m" name="result" class="'+c+'"><br><br><h2 class="center">Sorry no results found.</h2><br><br></li>'}else{$.each(b.ITEMS,function(f,e){if(e.COMPANYCLASSIFICATION<3){a+='<li data-theme="m" name="result" class="'+c+'"><a href="javascript:getCompany(\''+e.ID+'\')"><div class="roundedCornersDiv">';if(e.COMPANYCLASSIFICATION==1){a+='<div class="goldlisting"></div>'}a+='<img src="'+e.THUMBNAIL+'"></div><h2>'+e.LABEL+"</h2><h3>Type: "+e.PARENTCATEGORY+"\\"+e.CATEGORY+"</h3><h3>Region: "+e.REGIONNAME+"</h3><p>"+e.PITCHTEXT+"</p></a></li> ";if(c=="odd"){c="even"}else{c="odd"}}})}$("#results-listview").append(a);$("ul#results-listview").listview("refresh");$("."+current_category_txt.replace(/ /g,"_")).addClass("hidden");$(".tfilter").addClass("hidden");$("."+current_category_txt.replace(/ /g,"_")+".all").removeClass("hidden");$.each(b.CC,function(f,e){$("."+e.ID).removeClass("hidden");$("#count_"+e.ID).html("("+e.TOTAL+")")});$(".filter_location").addClass("hidden");$.each(b.CR,function(f,e){$(".filter_location."+e.LABEL.toLowerCase().replace(/ /g,"_")).removeClass("hidden");$("#count_"+e.LABEL.toLowerCase().replace(/ /g,"_")).html("("+e.TOTAL+")")});if(b.ITEMS.length==10&&current_searchstring==""){$("#results_more").removeClass("hidden")}else{$("#results_more").addClass("hidden")}$.mobile.hidePageLoadingMsg()}function getCompany(b){$.mobile.loadingMessage="loading";$.mobile.showPageLoadingMsg();var a=apiurl+"company/"+b+".js";getAjax(a,"getCompanyCallback")}function getCompanyCallback(c){var b="";var e="";var b="<h2 class='ui-li-divider'>"+c.LABEL+"</h2>";b+='<div data-scroll="x" class="threeByThree">';var a="";$.each(c.PHOTOS,function(g,f){a+='<a href="#"><img src="'+f.THUMBNAILPICTUREURL+'"></a>'});b+=a;b+=a;b+=a;b+="</div>";b+='<div id="companybody-indent">';b+="<h2>"+c.LABEL+"</h2>";if(c.ADDRESSLINE1!=""){b+="<h3>"+c.ADDRESSLINE1}if(c.ADDRESSLINE2!=""){b+=", "+c.ADDRESSLINE2}if(c.ADDRESSLINE1!=""){b+="</h3>"}if(c.ADDRESSLINE3!=""){b+="<h3>"+c.ADDRESSLINE3+"</h3>"}if(c.TELEPHONE!=""){b+='<h3>Tel: <a href="tel:'+c.TELEPHONE+'">'+c.TELEPHONE+"</a></h3>"}if(c.TELEPHONE2!=""){b+='<h3>Tel: <a href="tel:'+c.TELEPHONE2+'">'+c.TELEPHONE2+"</a></h3>"}if(c.WEBSITE!=""&&c.COMPANYMAPRECID!=""){b+='<h3><a href="http://www.mydestination.com/'+destination.toLowerCase().replace(/ /g,"")+"/Requests/TrackCompanyExternalPageClicking.cfm?CompanyMapId="+c.COMPANYMAPRECID+'" target="_blank">Website</a></h3>'}$("#converttotext").html(c.TEXT.replace(/iframe/g,"img").replace(/object/g,"img"));$("#converttotext a").remove();$("#converttotext img").remove();var d=$("#converttotext").text();if(c.TEXT!=""){b+='<br><div id="companyoverview"><h3><b>Overview</b></h3><p>'+d.replace(/\n/g,"<br>")+"</p>"}if(c.LON!=""&&c.LAT!=""){dlatitude=c.LAT;dlongitude=c.LON;b+='<br><h3><b>Click map for directions</b></h3><a href="javascript:getdirections = true; get_location();"><img src="http://maps.google.com/maps/api/staticmap?center='+c.LAT+","+c.LON+"&zoom="+c.GOOGLEMAPZOOMLEVEL+"&markers=size:mid|color:blue|"+c.LAT+","+c.LON+'&size=260x160&sensor=true"></a>'}b+="</div></div>";$("#companybody").html(b);$("#back-company").attr("href",location.hash);$.mobile.changePage("#company");scrollx();$.mobile.hidePageLoadingMsg()}function getDirections(){getdirections=false;$.mobile.changePage("#directions");$.mobile.loadingMessage="loading directions";$.mobile.showPageLoadingMsg();var c;var e=new google.maps.DirectionsService();var g;console.log("getdirections() src:"+latitude+","+longitude+" dest:"+dlatitude+","+dlongitude);c=new google.maps.DirectionsRenderer();var f=new google.maps.LatLng(latitude,longitude);var b={zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,center:f};g=new google.maps.Map(document.getElementById("map_canvas"),b);c.setMap(g);$("#directionsPanel").html("");c.setPanel(document.getElementById("directionsPanel"));var h=new google.maps.LatLng(latitude,longitude);var a=new google.maps.LatLng(dlatitude,dlongitude);var d={origin:h,destination:a,travelMode:google.maps.TravelMode.WALKING};e.route(d,function(i,j){if(j==google.maps.DirectionsStatus.OK){c.setDirections(i)}});console.log(e.routes);$.mobile.hidePageLoadingMsg()}function getAirports(){$.mobile.changePage("#airports");if($("#airports-listview").html()==""){$.mobile.loadingMessage="loading";$.mobile.showPageLoadingMsg();var a="http://api.mydestination.com/index.cfm/app/airports/"+destination_id+".js?dist=150";getAjax(a,"getAirportsCallback")}}function getAirportsCallback(a){$("#airports-listview").empty();$("#airports-listview").append('<li data-role="list-divider" data-theme="m">Select Airport</li>');if(a.AIRPORTS.length==0){$("#airports-listview").append('<li data-theme="m" name="result" class="odd"><br><br><h2 class="center">Sorry no airports close by found.</h2><br><br></li>')}else{$.each(a.AIRPORTS,function(c,b){if(c%2==0){b.CLASS="odd"}else{b.CLASS="even"}$("#airports-listview").append(Mustache.to_html($("#template_airports").html(),b))})}$("#airports-listview").listview("refresh");$.mobile.hidePageLoadingMsg()}function getFlights(){$.mobile.changePage("#airport");$.mobile.loadingMessage="loading flight data";$.mobile.showPageLoadingMsg();$("#flights-title").html(current_airport.replace(" Airport",""));var a=new Date();var d="http://api.mydestination.com/index.cfm/app/flights.js?airportCode="+current_airportcode+"&maxItems=40";if(current_flighttype=="departures"){var c=0;if(json_departures!=""){c=json_departures.TS}console.log(gettimestamp()+" "+(c+flight_cache_timeout));if((gettimestamp()>(c+flight_cache_timeout))||$("#departures-listview").html()==""){d+="&op=departures";d+="&dateMin="+dateFormat(a.getTime()-0.5*3600*1000,"isoDateTime");d+="&dateMax="+dateFormat(a.getTime()+4*3600*1000,"isoDateTime");getAjax(d,"getFlightsCallback")}else{setTimeout("$.mobile.hidePageLoadingMsg();",1000)}}if(current_flighttype=="arrivals"){var b=0;if(json_arrivals!=""){b=json_arrivals.TS}if((gettimestamp()>(b+flight_cache_timeout))||$("#arrivals-listview").html()==""){d+="&op=arrivals";d+="&dateMin="+dateFormat(a.getTime()-1*3600*1000,"isoDateTime");d+="&dateMax="+dateFormat(a.getTime()+2*3600*1000,"isoDateTime");getAjax(d,"getFlightsCallback")}else{setTimeout("$.mobile.hidePageLoadingMsg();",1000)}}}function getFlightsCallback(a){if(current_flighttype=="departures"){json_departures=a;json_departures.TS=gettimestamp();$("#departures-listview").empty();$.each(a.FLIGHTS,function(c,b){if(c%2==0){b.CLASS="odd"}else{b.CLASS="even"}b.AIRPORTCODE=b.DC;b.STATUSCOL="";b.TIME=$.format.date(b.DD.replace("T"," "),"HH:mm");b.AD=$.format.date(b.AD.replace("T"," "),"HH:mm");b.DD=$.format.date(b.DD.replace("T"," "),"HH:mm");if(b.DT!=""){b.DT=" Terminal "+b.DT}if(b.AT!=""){b.AT=" Terminal "+b.AT}switch(b.S){case"A":b.STATUS="Airborne";b.STATUSCOL="green";break;case"S":b.STATUS="Scheduled";break;case"C":b.STATUS="Cancelled";b.STATUSCOL="red";break;case"D":b.STATUS="Diverted";b.STATUSCOL="red";break;case"U":b.STATUS="Unknown";b.STATUSCOL="red";break;case"R":b.STATUS="Redirected";b.STATUSCOL="red";break;case"L":b.STATUS="Landed";b.STATUSCOL="green";break;case"DN":b.STATUS="Data Needed";break;case"NO":b.STATUS="Not Operational";break}$("#departures-listview").append(Mustache.to_html($("#template_flight").html(),b))});$("#departures-listview").listview("refresh")}if(current_flighttype=="arrivals"){json_arrivals=a;json_arrivals.TS=gettimestamp();$("#arrivals-listview").empty();$.each(a.FLIGHTS,function(c,b){if(c%2==0){b.CLASS="odd"}else{b.CLASS="even"}b.AIRPORTCODE=b.OC;b.STATUSCOL="";b.TIME=$.format.date(b.AD.replace("T"," "),"HH:mm");b.AD=$.format.date(b.AD.replace("T"," "),"HH:mm");b.DD=$.format.date(b.DD.replace("T"," "),"HH:mm");if(b.DT!=""){b.DT=" Terminal "+b.DT}if(b.AT!=""){b.AT=" Terminal "+b.AT}switch(b.S){case"A":b.STATUS="Airborne";break;case"S":b.STATUS="Scheduled";break;case"C":b.STATUS="Cancelled";b.STATUSCOL="red";break;case"D":b.STATUS="Diverted";b.STATUSCOL="red";break;case"U":b.STATUS="Unknown";b.STATUSCOL="red";break;case"R":b.STATUS="Redirected";b.STATUSCOL="red";break;case"L":b.STATUS="Landed";b.STATUSCOL="green";break;case"DN":b.STATUS="Data Needed";break;case"NO":b.STATUS="Not Operational";break}$("#arrivals-listview").append(Mustache.to_html($("#template_flight").html(),b))});$("#arrivals-listview").listview("refresh")}$.mobile.hidePageLoadingMsg()}function toggleflight(a){if($("#li-"+a+" .ui-icon").hasClass("ui-icon-arrow-d")){$("#li-"+a+" .ui-icon").removeClass("ui-icon-arrow-d").addClass("ui-icon-arrow-u");$("#div-"+a).attr("style","display:block")}else{$("#li-"+a+" .ui-icon").removeClass("ui-icon-arrow-u").addClass("ui-icon-arrow-d");$("#div-"+a).attr("style","display:none")}}function showDepartures(){current_flighttype="departures";$("#departures").attr("style","display:block");$("#arrivals").attr("style","display:none");$("#departures-listview").attr("style","display:block");$("#arrivals-listview").attr("style","display:none");getFlights()}function showArrivals(){current_flighttype="arrivals";$("#departures").attr("style","display:none");$("#arrivals").attr("style","display:block");$("#departures-listview").attr("style","display:none");$("#arrivals-listview").attr("style","display:block");getFlights()}function getWeather(){$.mobile.loadingMessage="updating weather";$.mobile.showPageLoadingMsg();var a=apiurl+"app/weather.js?id="+destination_id;getAjax(a,"getWeatherCallback")}function getWeatherCallback(b){fahrenheit=Math.round(((b.CURRENT.TEMP*9)/5)+32);if(weather=="c"){var a='<div class="ui-block-a"><h2>Currently</h2><h3>'+b.CURRENT.TEXT+'</h3></div><div class="ui-block-b"><div id="weather'+b.CURRENT.ICON+'" class="weather_sprites displayed"></div></div><div class="ui-block-c weather_c">'+b.CURRENT.TEMP+'&deg;</div><div class="ui-block-c weather_f weather-hidden">'+fahrenheit+"&deg;</div>"}else{var a='<div class="ui-block-a"><h2>Currently</h2><h3>'+b.CURRENT.TEXT+'</h3></div><div class="ui-block-b"><div id="weather'+b.CURRENT.ICON+'" class="weather_sprites displayed"></div></div><div class="ui-block-c weather_c weather-hidden">'+b.CURRENT.TEMP+'&deg;</div><div class="ui-block-c weather_f">'+fahrenheit+"&deg;</div>"}$("#weather_title").html(a);var a="";var c="odd";$.each(b.NEXT,function(e,d){fahrenheit_min=Math.round(((d.MIN*9)/5)+32);fahrenheit_max=Math.round(((d.MAX*9)/5)+32);if(weather=="c"){a+='<li><div class="ui-grid-b '+c+'"><div class="ui-block-a"><h2>'+d.DATE+'</h2></div><div class="ui-block-b"><div id="weather'+d.ICON+'" class="weather_sprites displayed"></div></div><div class="ui-block-c"><div id="" class="weather_c ui-grid-a"><div class="ui-block-a"><h3><b>'+d.MAX+'&deg;</b></h3></div><div class="ui-block-b"><h3>'+d.MIN+'&deg;</h3></div></div><div id="" class="weather_f ui-grid-a weather-hidden"><div class="ui-block-a"><h3><b>'+fahrenheit_max+'&deg;</b></h3></div><div class="ui-block-b"><h3>'+fahrenheit_min+"&deg;</h3></div></div></div></div></li>"}else{a+='<li><div class="ui-grid-b '+c+'"><div class="ui-block-a"><h2>'+d.DATE+'</h2></div><div class="ui-block-b"><div id="weather'+d.ICON+'" class="weather_sprites displayed"></div></div><div class="ui-block-c"><div id="" class="weather_c ui-grid-a weather-hidden"><div class="ui-block-a"><h3><b>'+d.MAX+'&deg;</b></h3></div><div class="ui-block-b"><h3>'+d.MIN+'&deg;</h3></div></div><div id="" class="weather_f ui-grid-a"><div class="ui-block-a"><h3><b>'+fahrenheit_max+'&deg;</b></h3></div><div class="ui-block-b"><h3>'+fahrenheit_min+"&deg;</h3></div></div></div></div></li>"}if(c=="odd"){c="even"}else{c="odd"}});$("#weather-listview").html(a);$.mobile.hidePageLoadingMsg()}function toggle_weather(){if($(".weather_f").hasClass("weather-hidden")){$(".weather_f").removeClass("weather-hidden");$(".weather_c").addClass("weather-hidden");weather="f"}else{$(".weather_c").removeClass("weather-hidden");$(".weather_f").addClass("weather-hidden");weather="c"}if(typeof(localStorage)!="undefined"){localStorage.setItem("weather",weather)}}function set_destination_sub(a){$.mobile.changePage("#destinations-sub");$.mobile.loadingMessage="loading";$.mobile.showPageLoadingMsg();$("#destination-sub-title").html(a);a=a.toLowerCase().replace(/ /g,"-")+"-listview";$("#div-search ul").attr("style","display:none");$("#"+a).attr("style","display:block");console.log("set_destination_sub: "+a);$("#div-search .ui-listview-filter").attr("style","display:none");$("#"+a).prev().attr("style","display:block");$.mobile.hidePageLoadingMsg()}function setfilter(a,b,c){console.log(a+","+b+","+c);b=b.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"");if(a=="location"){current_category_location=b;$("#flocation").html("Location ("+b+")")}if(a=="sortby"){current_category_sort=b;if(b=="name"){b="A-Z"}if(b=="creation"){b="Most recent"}$("#fsortby").html("Sort By ("+b+")")}if(a=="type"){current_category_type=b;$("#ftype").html("Type ("+b+")");ftype_id=c}getCategoryId(c,false,"")}function filter(){$("#div-filter").slideToggle();if($("#settings .ui-icon").hasClass("ui-icon-arrow-d")){$("#settings .ui-icon").removeClass("ui-icon-arrow-d").addClass("ui-icon-arrow-u")}else{$("#settings .ui-icon").removeClass("ui-icon-arrow-u").addClass("ui-icon-arrow-d")}}function getAjax(a,b){$.ajax({url:a,type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:b,error:function(e,c,d){console.log("Error: "+a);$.mobile.hidePageLoadingMsg();alert("Error connecting to the server. Please try again.")},success:function(c){}})}function gettimestamp(){return Math.round((new Date()).getTime()/1000)}var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,c=function(f,e){f=String(f);e=e||2;while(f.length<e){f="0"+f}return f};return function(i,v,q){var g=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){v=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i)){throw SyntaxError("invalid date")}v=String(g.masks[v]||v||g.masks["default"]);if(v.slice(0,4)=="UTC:"){v=v.slice(4);q=true}var t=q?"getUTC":"get",l=i[t+"Date"](),e=i[t+"Day"](),j=i[t+"Month"](),p=i[t+"FullYear"](),r=i[t+"Hours"](),k=i[t+"Minutes"](),u=i[t+"Seconds"](),n=i[t+"Milliseconds"](),f=q?0:i.getTimezoneOffset(),h={d:l,dd:c(l),ddd:g.i18n.dayNames[e],dddd:g.i18n.dayNames[e+7],m:j+1,mm:c(j+1),mmm:g.i18n.monthNames[j],mmmm:g.i18n.monthNames[j+12],yy:String(p).slice(2),yyyy:p,h:r%12||12,hh:c(r%12||12),H:r,HH:c(r),M:k,MM:c(k),s:u,ss:c(u),l:c(n,3),L:c(n>99?Math.round(n/10):n),t:r<12?"a":"p",tt:r<12?"am":"pm",T:r<12?"A":"P",TT:r<12?"AM":"PM",Z:q?"UTC":(String(i).match(b)||[""]).pop().replace(d,""),o:(f>0?"-":"+")+c(Math.floor(Math.abs(f)/60)*100+Math.abs(f)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return v.replace(a,function(m){return m in h?h[m]:m.slice(1,m.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(a,b){return dateFormat(this,a,b)};function closeSplash(){if(startpage!=""){$.mobile.changePage("#"+startpage,{transition:"fade"});startpage=""}}function getDistance(a){if(a<1){a=((Math.round(a*100)/100)*1000)+"m"}else{a=(Math.round(a*100)/100)+"km"}return a}function scrollx(){$("#nearmenow").find(":jqmData(scroll):not(.ui-scrollview-clip)").each(function(){var e=$(this);if(e.hasClass("ui-scrolllistview")){e.scrolllistview()}else{var c=e.jqmData("scroll")+"";var a=c&&c.search(/^[xy]p$/)!=-1;var b=c&&c.search(/^[xy]/)!=-1?c.charAt(0):null;var d={};if(b){d.direction=b}if(a){d.pagingEnabled=true}var f=e.jqmData("scroll-method");if(f){d.scrollMethod=f}e.scrollview(d)}});$("#company").find(":jqmData(scroll):not(.ui-scrollview-clip)").each(function(){var e=$(this);if(e.hasClass("ui-scrolllistview")){e.scrolllistview()}else{var c=e.jqmData("scroll")+"";var a=c&&c.search(/^[xy]p$/)!=-1;var b=c&&c.search(/^[xy]/)!=-1?c.charAt(0):null;var d={};if(b){d.direction=b}if(a){d.pagingEnabled=true}var f=e.jqmData("scroll-method");if(f){d.scrollMethod=f}e.scrollview(d)}})}(function(f,e,b,h){jQuery.widget("mobile.scrollview",jQuery.mobile.widget,{options:{fps:60,direction:null,scrollDuration:2000,overshootDuration:250,snapbackDuration:500,moveThreshold:10,moveIntervalThreshold:150,scrollMethod:"translate",startEventName:"scrollstart",updateEventName:"scrollupdate",stopEventName:"scrollstop",eventType:f.support.touch?"touch":"mouse",showScrollBars:false,pagingEnabled:false,delayedClickSelector:"a,input,textarea,select,button,.ui-btn",delayedClickEnabled:false},_makePositioned:function(i){if(i.css("position")=="static"){i.css("position","relative")}},_create:function(){this._$clip=f(this.element).addClass("ui-scrollview-clip");var j=this._$clip.children();if(j.length>1){j=this._$clip.wrapInner("<div></div>").children()}this._$view=j.addClass("ui-scrollview-view");this._$clip.css("overflow",this.options.scrollMethod==="scroll"?"scroll":"hidden");this._makePositioned(this._$clip);this._$view.css("overflow","hidden");this.options.showScrollBars=this.options.scrollMethod==="scroll"?false:this.options.showScrollBars;this._makePositioned(this._$view);this._$view.css({left:0,top:0});this._sx=0;this._sy=0;var k=this.options.direction;this._hTracker=(k!=="y")?new g(this.options):null;this._vTracker=(k!=="x")?new g(this.options):null;this._timerInterval=1000/this.options.fps;this._timerID=0;var i=this;this._timerCB=function(){i._handleMomentumScroll()};this._addBehaviors()},_startMScroll:function(l,k){this._stopMScroll();this._showScrollBars();var n=false;var m=this.options.scrollDuration;this._$clip.trigger(this.options.startEventName);var j=this._hTracker;if(j){var p=this._$clip.width();var i=this._$view.width();j.start(this._sx,l,m,(i>p)?-(i-p):0,0);n=!j.done()}var o=this._vTracker;if(o){var p=this._$clip.height();var i=this._$view.height();o.start(this._sy,k,m,(i>p)?-(i-p):0,0);n=n||!o.done()}if(n){this._timerID=setTimeout(this._timerCB,this._timerInterval)}else{this._stopMScroll()}},_stopMScroll:function(){if(this._timerID){this._$clip.trigger(this.options.stopEventName);clearTimeout(this._timerID)}this._timerID=0;if(this._vTracker){this._vTracker.reset()}if(this._hTracker){this._hTracker.reset()}this._hideScrollBars()},_handleMomentumScroll:function(){var l=false;var j=this._$view;var i=0,n=0;var m=this._vTracker;if(m){m.update();n=m.getPosition();l=!m.done()}var k=this._hTracker;if(k){k.update();i=k.getPosition();l=l||!k.done()}this._setScrollPosition(i,n);this._$clip.trigger(this.options.updateEventName,[{x:i,y:n}]);if(l){this._timerID=setTimeout(this._timerCB,this._timerInterval)}else{this._stopMScroll()}},_setScrollPosition:function(i,p){this._sx=i;this._sy=p;var m=this._$view;var o=this.options.scrollMethod;switch(o){case"translate":c(m,i+"px",p+"px");break;case"position":m.css({left:i+"px",top:p+"px"});break;case"scroll":var n=this._$clip[0];n.scrollLeft=-i;n.scrollTop=-p;break}var j=this._$vScrollBar;var k=this._$hScrollBar;if(j){var l=j.find(".ui-scrollbar-thumb");if(o==="translate"){c(l,"0px",-p/m.height()*l.parent().height()+"px")}else{l.css("top",-p/m.height()*100+"%")}}if(k){var l=k.find(".ui-scrollbar-thumb");if(o==="translate"){c(l,-i/m.width()*l.parent().width()+"px","0px")}else{l.css("left",-i/m.width()*100+"%")}}},scrollTo:function(p,m,k){this._stopMScroll();if(!k){return this._setScrollPosition(p,m)}p=-p;m=-m;var r=this;var i=d();var l=f.easing.easeOutQuad;var o=this._sx;var n=this._sy;var s=p-o;var q=m-n;var j=function(){var t=d()-i;if(t>=k){r._timerID=0;r._setScrollPosition(p,m)}else{var u=l(t/k,t,0,1,k);r._setScrollPosition(o+(s*u),n+(q*u));r._timerID=setTimeout(j,r._timerInterval)}};this._timerID=setTimeout(j,this._timerInterval)},getScrollPosition:function(){return{x:-this._sx,y:-this._sy}},_getScrollHierarchy:function(){var i=[];this._$clip.parents(".ui-scrollview-clip").each(function(){var j=f(this).jqmData("scrollview");if(j){i.unshift(j)}});return i},_getAncestorByDirection:function(k){var j=this._getScrollHierarchy();var m=j.length;while(0<m--){var i=j[m];var l=i.options.direction;if(!l||l==k){return i}}return null},_handleDragStart:function(m,o,n){f.each(this._getScrollHierarchy(),function(t,s){s._stopMScroll()});this._stopMScroll();var p=this._$clip;var r=this._$view;if(this.options.delayedClickEnabled){this._$clickEle=f(m.target).closest(this.options.delayedClickSelector)}this._lastX=o;this._lastY=n;this._doSnapBackX=false;this._doSnapBackY=false;this._speedX=0;this._speedY=0;this._directionLock="";this._didDrag=false;if(this._hTracker){var j=parseInt(p.css("width"),10);var q=parseInt(r.css("width"),10);this._maxX=j-q;if(this._maxX>0){this._maxX=0}if(this._$hScrollBar){this._$hScrollBar.find(".ui-scrollbar-thumb").css("width",(j>=q?"100%":Math.floor(j/q*100)+"%"))}}if(this._vTracker){var i=parseInt(p.css("height"),10);var k=parseInt(r.css("height"),10);this._maxY=i-k;if(this._maxY>0){this._maxY=0}if(this._$vScrollBar){this._$vScrollBar.find(".ui-scrollbar-thumb").css("height",(i>=k?"100%":Math.floor(i/k*100)+"%"))}}var l=this.options.direction;this._pageDelta=0;this._pageSize=0;this._pagePos=0;if(this.options.pagingEnabled&&(l==="x"||l==="y")){this._pageSize=l==="x"?j:i;this._pagePos=l==="x"?this._sx:this._sy;this._pagePos-=this._pagePos%this._pageSize}this._lastMove=0;this._enableTracking();if(this.options.eventType=="mouse"||this.options.delayedClickEnabled){m.preventDefault()}m.stopPropagation()},_propagateDragMove:function(i,m,l,k,j){this._hideScrollBars();this._disableTracking();i._handleDragStart(m,l,k);i._directionLock=j;i._didDrag=this._didDrag},_handleDragMove:function(A,z,u){this._lastMove=d();var o=this._$view;var n=z-this._lastX;var m=u-this._lastY;var j=this.options.direction;if(!this._directionLock){var l=Math.abs(n);var k=Math.abs(m);var t=this.options.moveThreshold;if(l<t&&k<t){return false}var s=null;var p=0;if(l<k&&(l/k)<0.5){s="y"}else{if(l>k&&(k/l)<0.5){s="x"}}if(j&&s&&j!=s){var q=this._getAncestorByDirection(s);if(q){this._propagateDragMove(q,A,z,u,s);return false}}this._directionLock=j?j:(s?s:"none")}var C=this._sx;var B=this._sy;if(this._directionLock!=="y"&&this._hTracker){var l=this._sx;this._speedX=n;C=l+n;this._doSnapBackX=false;if(C>0||C<this._maxX){if(this._directionLock==="x"){var q=this._getAncestorByDirection("x");if(q){this._setScrollPosition(C>0?0:this._maxX,B);this._propagateDragMove(q,A,z,u,s);return false}}C=l+(n/2);this._doSnapBackX=true}}if(this._directionLock!=="x"&&this._vTracker){var k=this._sy;this._speedY=m;B=k+m;this._doSnapBackY=false;if(B>0||B<this._maxY){if(this._directionLock==="y"){var q=this._getAncestorByDirection("y");if(q){this._setScrollPosition(C,B>0?0:this._maxY);this._propagateDragMove(q,A,z,u,s);return false}}B=k+(m/2);this._doSnapBackY=true}}if(this.options.pagingEnabled&&(j==="x"||j==="y")){if(this._doSnapBackX||this._doSnapBackY){this._pageDelta=0}else{var w=this._pagePos;var i=j==="x"?C:B;var D=j==="x"?n:m;this._pageDelta=(w>i&&D<0)?this._pageSize:((w<i&&D>0)?-this._pageSize:0)}}this._didDrag=true;this._lastX=z;this._lastY=u;this._setScrollPosition(C,B);this._showScrollBars();return false},_handleDragStop:function(m){var i=this._lastMove;var r=d();var j=i&&(r-i)<=this.options.moveIntervalThreshold;var p=(this._hTracker&&this._speedX&&j)?this._speedX:(this._doSnapBackX?1:0);var o=(this._vTracker&&this._speedY&&j)?this._speedY:(this._doSnapBackY?1:0);var k=this.options.direction;if(this.options.pagingEnabled&&(k==="x"||k==="y")&&!this._doSnapBackX&&!this._doSnapBackY){var q=this._sx;var n=this._sy;if(k==="x"){q=-this._pagePos+this._pageDelta}else{n=-this._pagePos+this._pageDelta}this.scrollTo(q,n,this.options.snapbackDuration)}else{if(p||o){this._startMScroll(p,o)}else{this._hideScrollBars()}}this._disableTracking();if(!this._didDrag&&this.options.delayedClickEnabled&&this._$clickEle.length){this._$clickEle.trigger("mousedown").trigger("mouseup").trigger("click")}return this._didDrag?false:h},_enableTracking:function(){f(b).bind(this._dragMoveEvt,this._dragMoveCB);f(b).bind(this._dragStopEvt,this._dragStopCB)},_disableTracking:function(){f(b).unbind(this._dragMoveEvt,this._dragMoveCB);f(b).unbind(this._dragStopEvt,this._dragStopCB)},_showScrollBars:function(){var i="ui-scrollbar-visible";if(this._$vScrollBar){this._$vScrollBar.addClass(i)}if(this._$hScrollBar){this._$hScrollBar.addClass(i)}},_hideScrollBars:function(){var i="ui-scrollbar-visible";if(this._$vScrollBar){this._$vScrollBar.removeClass(i)}if(this._$hScrollBar){this._$hScrollBar.removeClass(i)}},_addBehaviors:function(){var i=this;if(this.options.eventType==="mouse"){this._dragStartEvt="mousedown";this._dragStartCB=function(m){return i._handleDragStart(m,m.clientX,m.clientY)};this._dragMoveEvt="mousemove";this._dragMoveCB=function(m){return i._handleDragMove(m,m.clientX,m.clientY)};this._dragStopEvt="mouseup";this._dragStopCB=function(m){return i._handleDragStop(m)}}else{this._dragStartEvt="touchstart";this._dragStartCB=function(n){var m=n.originalEvent.targetTouches[0];return i._handleDragStart(n,m.pageX,m.pageY)};this._dragMoveEvt="touchmove";this._dragMoveCB=function(n){var m=n.originalEvent.targetTouches[0];return i._handleDragMove(n,m.pageX,m.pageY)};this._dragStopEvt="touchend";this._dragStopCB=function(m){return i._handleDragStop(m)}}this._$view.bind(this._dragStartEvt,this._dragStartCB);if(this.options.showScrollBars){var j=this._$clip;var k='<div class="ui-scrollbar ui-scrollbar-';var l='"><div class="ui-scrollbar-track"><div class="ui-scrollbar-thumb"></div></div></div>';if(this._vTracker){j.append(k+"y"+l);this._$vScrollBar=j.children(".ui-scrollbar-y")}if(this._hTracker){j.append(k+"x"+l);this._$hScrollBar=j.children(".ui-scrollbar-x")}}}});function c(k,i,l){var j="translate3d("+i+","+l+", 0px)";k.css({"-moz-transform":j,"-webkit-transform":j,transform:j})}function g(i){this.options=f.extend({},i);this.easing="easeOutQuad";this.reset()}var a={scrolling:0,overshot:1,snapback:2,done:3};function d(){return(new Date()).getTime()}f.extend(g.prototype,{start:function(m,k,l,j,i){this.state=(k!=0)?((m<j||m>i)?a.snapback:a.scrolling):a.done;this.pos=m;this.speed=k;this.duration=(this.state==a.snapback)?this.options.snapbackDuration:l;this.minPos=j;this.maxPos=i;this.fromPos=(this.state==a.snapback)?this.pos:0;this.toPos=(this.state==a.snapback)?((this.pos<this.minPos)?this.minPos:this.maxPos):0;this.startTime=d()},reset:function(){this.state=a.done;this.pos=0;this.speed=0;this.minPos=0;this.maxPos=0;this.duration=0},update:function(){var m=this.state;if(m==a.done){return this.pos}var n=this.duration;var j=d()-this.startTime;j=j>n?n:j;if(m==a.scrolling||m==a.overshot){var k=this.speed*(1-f.easing[this.easing](j/n,j,0,1,n));var i=this.pos+k;var l=(m==a.scrolling)&&(i<this.minPos||i>this.maxPos);if(l){i=(i<this.minPos)?this.minPos:this.maxPos}this.pos=i;if(m==a.overshot){if(j>=n){this.state=a.snapback;this.fromPos=this.pos;this.toPos=(i<this.minPos)?this.minPos:this.maxPos;this.duration=this.options.snapbackDuration;this.startTime=d();j=0}}else{if(m==a.scrolling){if(l){this.state=a.overshot;this.speed=k/2;this.duration=this.options.overshootDuration;this.startTime=d()}else{if(j>=n){this.state=a.done}}}}}else{if(m==a.snapback){if(j>=n){this.pos=this.toPos;this.state=a.done}else{this.pos=this.fromPos+((this.toPos-this.fromPos)*f.easing[this.easing](j/n,j,0,1,n))}}}return this.pos},done:function(){return this.state==a.done},getPosition:function(){return this.pos}});jQuery.widget("mobile.scrolllistview",jQuery.mobile.scrollview,{options:{direction:"y"},_create:function(){f.mobile.scrollview.prototype._create.call(this);this._$dividers=this._$view.find(":jqmData(role='list-divider')");this._lastDivider=null},_setScrollPosition:function(s,r){f.mobile.scrollview.prototype._setScrollPosition.call(this,s,r);r=-r;var o=this._$dividers;var k=o.length;var p=null;var v=0;var l=null;for(var m=0;m<k;m++){l=o.get(m);var u=l.offsetTop;if(r>=u){p=l;v=u}else{if(p){break}}}if(p){var n=p.offsetHeight;var q=(p!=l)?l.offsetTop:(this._$view.get(0).offsetHeight);if(r+n>=q){r=(q-n)-v}else{r=r-v}var j=this._lastDivider;if(j&&p!=j){c(f(j),0,0)}c(f(p),0,r+"px");this._lastDivider=p}}})})(jQuery,window,document);jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k/2)==2){return e+l}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+l+e},easeInBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return i/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return i/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});(function(e){var b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var c=["January","February","March","April","May","June","July","August","September","October","November","December"];var a=[];a.Jan="01";a.Feb="02";a.Mar="03";a.Apr="04";a.May="05";a.Jun="06";a.Jul="07";a.Aug="08";a.Sep="09";a.Oct="10";a.Nov="11";a.Dec="12";e.format=(function(){function i(k){return b[parseInt(k,10)]||k}function j(l){var k=parseInt(l,10)-1;return d[k]||l}function h(l){var k=parseInt(l,10)-1;return c[k]||l}var f=function(k){return a[k]||k};var g=function(n){var o=n;var l="";if(o.indexOf(".")!==-1){var m=o.split(".");o=m[0];l=m[1]}var k=o.split(":");if(k.length===3){hour=k[0];minute=k[1];second=k[2];return{time:o,hour:hour,minute:minute,second:second,millis:l}}else{return{time:"",hour:"",minute:"",second:"",millis:""}}};return{date:function(w,v){try{var l=null;var s=null;var q=null;var y=null;var m=null;var k=null;if(typeof w.getFullYear==="function"){s=w.getFullYear();q=w.getMonth()+1;y=w.getDate();m=w.getDay();k=g(w.toTimeString())}else{if(w.search(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}[-+]?\d{2}:\d{2}/)!=-1){var x=w.split(/[T\+-]/);s=x[0];q=x[1];y=x[2];k=g(x[3].split(".")[0]);l=new Date(s,q-1,y);m=l.getDay()}else{var x=w.split(" ");switch(x.length){case 6:s=x[5];q=f(x[1]);y=x[2];k=g(x[3]);l=new Date(s,q-1,y);m=l.getDay();break;case 2:var u=x[0].split("-");s=u[0];q=u[1];y=u[2];k=g(x[1]);l=new Date(s,q-1,y);m=l.getDay();break;case 7:case 9:case 10:s=x[3];q=f(x[1]);y=x[2];k=g(x[4]);l=new Date(s,q-1,y);m=l.getDay();break;default:return w}}}var r="";var o="";for(var n=0;n<v.length;n++){var t=v.charAt(n);r+=t;switch(r){case"ddd":o+=i(m);r="";break;case"dd":if(v.charAt(n+1)=="d"){break}if(String(y).length===1){y="0"+y}o+=y;r="";break;case"MMMM":o+=h(q);r="";break;case"MMM":if(v.charAt(n+1)==="M"){break}o+=j(q);r="";break;case"MM":if(v.charAt(n+1)=="M"){break}if(String(q).length===1){q="0"+q}o+=q;r="";break;case"yyyy":o+=s;r="";break;case"HH":o+=k.hour;r="";break;case"hh":o+=(k.hour==0?12:k.hour<13?k.hour:k.hour-12);r="";break;case"mm":o+=k.minute;r="";break;case"ss":o+=k.second.substring(0,2);r="";break;case"SSS":o+=k.millis.substring(0,3);r="";break;case"a":o+=k.hour>=12?"PM":"AM";r="";break;case" ":o+=t;r="";break;case"/":o+=t;r="";break;case":":o+=t;r="";break;default:if(r.length===2&&r.indexOf("y")!==0&&r!="SS"){o+=r.substring(0,1);r=r.substring(1,2)}else{if((r.length===3&&r.indexOf("yyy")===-1)){r=""}}}}return o}catch(p){console.log(p);return w}}}}())}(jQuery));$(document).ready(function(){$(".shortDateFormat").each(function(a,b){if($(b).is(":input")){$(b).val($.format.date($(b).val(),"dd/MM/yyyy"))}else{$(b).text($.format.date($(b).text(),"dd/MM/yyyy"))}});$(".longDateFormat").each(function(a,b){if($(b).is(":input")){$(b).val($.format.date($(b).val(),"dd/MM/yyyy hh:mm:ss"))}else{$(b).text($.format.date($(b).text(),"dd/MM/yyyy hh:mm:ss"))}})});var Mustache=function(){var a=function(){};a.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(e,d,c,f){if(!f){this.context=d;this.buffer=[]}if(!this.includes("",e)){if(f){return e}else{this.send(e);return}}e=this.render_pragmas(e);var b=this.render_section(e,d,c);if(f){return this.render_tags(b,d,c,f)}this.render_tags(b,d,c,f)},send:function(b){if(b!==""){this.buffer.push(b)}},render_pragmas:function(b){if(!this.includes("%",b)){return b}var d=this;var c=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag,"g");return b.replace(c,function(g,e,f){if(!d.pragmas_implemented[e]){throw ({message:"This implementation of mustache doesn't understand the '"+e+"' pragma"})}d.pragmas[e]={};if(f){var h=f.split("=");d.pragmas[e][h[0]]=h[1]}return""})},render_partial:function(b,d,c){b=this.trim(b);if(!c||c[b]===undefined){throw ({message:"unknown_partial '"+b+"'"})}if(typeof(d[b])!="object"){return this.render(c[b],d,c,true)}return this.render(c[b],d[b],c,true)},render_section:function(d,c,b){if(!this.includes("#",d)&&!this.includes("^",d)){return d}var f=this;var e=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg");return d.replace(e,function(h,i,g,j){var k=f.find(g,c);if(i=="^"){if(!k||f.is_array(k)&&k.length===0){return f.render(j,c,b,true)}else{return""}}else{if(i=="#"){if(f.is_array(k)){return f.map(k,function(l){return f.render(j,f.create_context(l),b,true)}).join("")}else{if(f.is_object(k)){return f.render(j,f.create_context(k),b,true)}else{if(typeof k==="function"){return k.call(c,j,function(l){return f.render(l,c,b,true)})}else{if(k){return f.render(j,c,b,true)}else{return""}}}}}}})},render_tags:function(k,b,d,f){var e=this;var j=function(){return new RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")};var g=j();var h=function(n,i,m){switch(i){case"!":return"";case"=":e.set_delimiters(m);g=j();return"";case">":return e.render_partial(m,b,d);case"{":return e.find(m,b);default:return e.escape(e.find(m,b))}};var l=k.split("\n");for(var c=0;c<l.length;c++){l[c]=l[c].replace(g,h,this);if(!f){this.send(l[c])}}if(f){return l.join("\n")}},set_delimiters:function(c){var b=c.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(c){if(!arguments.callee.sRE){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+b.join("|\\")+")","g")}return c.replace(arguments.callee.sRE,"\\$1")},find:function(c,d){c=this.trim(c);function b(f){return f===false||f===0||f}var e;if(b(d[c])){e=d[c]}else{if(b(this.context[c])){e=this.context[c]}}if(typeof e==="function"){return e.apply(d)}if(e!==undefined){return e}return""},includes:function(c,b){return b.indexOf(this.otag+c)!=-1},escape:function(b){b=String(b===null?"":b);return b.replace(/&(?!\w+;)|["'<>\\]/g,function(c){switch(c){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return c}})},create_context:function(c){if(this.is_object(c)){return c}else{var d=".";if(this.pragmas["IMPLICIT-ITERATOR"]){d=this.pragmas["IMPLICIT-ITERATOR"].iterator}var b={};b[d]=c;return b}},is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(f,d){if(typeof f.map=="function"){return f.map(d)}else{var e=[];var b=f.length;for(var c=0;c<b;c++){e.push(d(f[c]))}return e}}};return({name:"mustache.js",version:"0.3.1-dev",to_html:function(d,b,c,f){var e=new a();if(f){e.send=f}e.render(d,b,c);if(!f){return e.buffer.join("\n")}}})}();
/*!
 * Add to Homescreen v1.0.8 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
(function(){var j=navigator,k=(/iphone|ipod|ipad/gi).test(j.platform),w=(/ipad/gi).test(j.platform),o="devicePixelRatio" in window&&window.devicePixelRatio>1,x=j.appVersion.match(/Safari/gi),a="standalone" in j&&k,z=a&&j.standalone,f=j.appVersion.match(/OS \d+_\d+/g),y=j.platform.split(" ")[0],q=j.language.replace("-","_"),v=startX=0,g=localStorage.getItem("_addToHome"),t,m,b,u,r,e={animationIn:"drop",animationOut:"fade",startDelay:2000,lifespan:20000,bottomOffset:14,expire:0,message:"",touchIcon:false,arrow:true,iterations:100},p={ca_es:"Per instal·lar aquesta aplicació al vostre %device premeu %icon i llavors <strong>Afegir a pantalla d'inici</strong>.",da_dk:"Tilføj denne side til din %device: tryk på %icon og derefter <strong>Tilføj til hjemmeskærm</strong>.",de_de:"Installieren Sie diese App auf Ihrem %device: %icon antippen und dann <strong>Zum Home-Bildschirm</strong>.",el_gr:"Εγκαταστήσετε αυτήν την Εφαρμογή στήν συσκευή σας %device: %icon μετά πατάτε <strong>Προσθήκη σε Αφετηρία</strong>.",en_us:"Install this web app on your %device: tap %icon and then <strong>Add to Home Screen</strong>.",es_es:"Para instalar esta app en su %device, pulse %icon y seleccione <strong>Añadir a pantalla de inicio</strong>.",fi_fi:"Asenna tämä web-sovellus laitteeseesi %device: paina %icon ja sen jälkeen valitse <strong>Lisää Koti-valikkoon</strong>.",fr_fr:"Ajoutez cette application sur votre %device en cliquant sur %icon, puis <strong>Ajouter à l'écran d'accueil</strong>.",he_il:'<span dir="rtl">התקן אפליקציה זו על ה-%device שלך: הקש %icon ואז <strong>הוסף למסך הבית</strong>.</span>',hu_hu:"Telepítse ezt a web-alkalmazást az Ön %device-jára: nyomjon a %icon-ra majd a <strong>Főképernyőhöz adás</strong> gombra.",it_it:"Installa questa applicazione sul tuo %device: premi su %icon e poi <strong>Aggiungi a Home</strong>.",ja_jp:"このウェブアプリをあなたの%deviceにインストールするには%iconをタップして<strong>ホーム画面に追加</strong>を選んでください。",ko_kr:'%device에 웹앱을 설치하려면 %icon을 터치 후 "홈화면에 추가"를 선택하세요',nb_no:"Installer denne appen på din %device: trykk på %icon og deretter <strong>Legg til på Hjem-skjerm</strong>",nl_nl:"Installeer deze webapp op uw %device: tik %icon en dan <strong>Zet in beginscherm</strong>.",pt_br:"Instale este web app em seu %device: aperte %icon e selecione <strong>Adicionar à Tela Inicio</strong>.",pt_pt:"Para instalar esta aplicação no seu %device, prima o %icon e depois o <strong>Adicionar ao ecrã principal</strong>.",ru_ru:"Установите это веб-приложение на ваш %device: нажмите %icon, затем <strong>Добавить в «Домой»</strong>.",sv_se:"Lägg till denna webbapplikation på din %device: tryck på %icon och därefter <strong>Lägg till på hemskärmen</strong>.",th_th:"ติดตั้งเว็บแอพฯ นี้บน %device ของคุณ: แตะ %icon และ <strong>เพิ่มที่หน้าจอโฮม</strong>",tr_tr:"%device için bu uygulamayı kurduktan sonra %icon simgesine dokunarak <strong>Ev Ekranına Ekle</strong>yin.",zh_cn:"您可以将此应用程式安装到您的 %device 上。请按 %icon 然后点选<strong>添加至主屏幕</strong>。",zh_tw:"您可以將此應用程式安裝到您的 %device 上。請按 %icon 然後點選<strong>加入主畫面螢幕</strong>。"};f=f?f[0].replace(/[^\d_]/g,"").replace("_",".")*1:0;g=g=="null"?0:g*1;if(window.addToHomeConfig){for(u in window.addToHomeConfig){e[u]=window.addToHomeConfig[u]}}if(!e.expire||g<new Date().getTime()){g=0}if(a&&!g&&!z&&x){document.addEventListener("DOMContentLoaded",n,false);window.addEventListener("load",s,false)}function n(){document.removeEventListener("DOMContentLoaded",n,false);var C=document.createElement("div"),B,A=e.touchIcon?document.querySelectorAll("head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]"):[],l,i="";C.id="addToHomeScreen";C.style.cssText+="position:absolute;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);";C.style.left="-9999px";if(e.message in p){q=e.message;e.message=""}if(e.message==""){e.message=q in p?p[q]:p.en_us}if(A.length){for(u=0,r=A.length;u<r;u++){l=A[u].getAttribute("sizes");if(l){if(o&&l=="114x114"){i=A[u].href;break}}else{i=A[u].href}}i='<span style="background-image:url('+i+')" class="touchIcon"></span>'}C.className=(w?"ipad":"iphone")+(i?" wide":"");C.innerHTML=i+e.message.replace("%device",y).replace("%icon",f>=4.2?'<span class="share"></span>':'<span class="plus">+</span>')+(e.arrow?'<span class="arrow"></span>':"")+'<span class="close">\u00D7</span>';document.body.appendChild(C);b=C;B=b.querySelector(".close");if(B){B.addEventListener("click",c,false)}if(e.expire){localStorage.setItem("_addToHome",new Date().getTime()+e.expire*60*1000)}}function s(){window.removeEventListener("load",s,false);setTimeout(function(){var i;v=w?window.scrollY:window.innerHeight+window.scrollY;startX=w?window.scrollX:Math.round((window.innerWidth-b.offsetWidth)/2)+window.scrollX;b.style.top=w?v+e.bottomOffset+"px":v-b.offsetHeight-e.bottomOffset+"px";b.style.left=w?startX+(f>=5?160:208)-Math.round(b.offsetWidth/2)+"px":startX+"px";switch(e.animationIn){case"drop":if(w){i="0.6s";b.style.webkitTransform="translate3d(0,"+-(window.scrollY+e.bottomOffset+b.offsetHeight)+"px,0)"}else{i="0.9s";b.style.webkitTransform="translate3d(0,"+-(v+e.bottomOffset)+"px,0)"}break;case"bubble":if(w){i="0.6s";b.style.opacity="0";b.style.webkitTransform="translate3d(0,"+(v+50)+"px,0)"}else{i="0.6s";b.style.webkitTransform="translate3d(0,"+(b.offsetHeight+e.bottomOffset+50)+"px,0)"}break;default:i="1s";b.style.opacity="0"}setTimeout(function(){b.style.webkitTransitionDuration=i;b.style.opacity="1";b.style.webkitTransform="translate3d(0,0,0)";b.addEventListener("webkitTransitionEnd",h,false)},0);m=setTimeout(c,e.lifespan)},e.startDelay)}function h(){b.removeEventListener("webkitTransitionEnd",h,false);b.style.webkitTransitionProperty="-webkit-transform";b.style.webkitTransitionDuration="0.2s";if(m){clearInterval(t);t=setInterval(d,e.iterations)}else{b.parentNode.removeChild(b)}}function d(){var i=new WebKitCSSMatrix(window.getComputedStyle(b,null).webkitTransform),l=w?window.scrollY-v:window.scrollY+window.innerHeight-v,A=w?window.scrollX-startX:window.scrollX+Math.round((window.innerWidth-b.offsetWidth)/2)-startX;if(l==i.m42&&A==i.m41){return}clearInterval(t);b.removeEventListener("webkitTransitionEnd",h,false);setTimeout(function(){b.addEventListener("webkitTransitionEnd",h,false);b.style.webkitTransform="translate3d("+A+"px,"+l+"px,0)"},0)}function c(){clearInterval(t);clearTimeout(m);m=null;b.removeEventListener("webkitTransitionEnd",h,false);var B=w?window.scrollY-v:window.scrollY+window.innerHeight-v,C=w?window.scrollX-startX:window.scrollX+Math.round((window.innerWidth-b.offsetWidth)/2)-startX,i="1",l="0",A=b.querySelector(".close");if(A){A.removeEventListener("click",c,false)}b.style.webkitTransitionProperty="-webkit-transform,opacity";switch(e.animationOut){case"drop":if(w){l="0.4s";i="0";B=B+50}else{l="0.6s";B=B+b.offsetHeight+e.bottomOffset+50}break;case"bubble":if(w){l="0.8s";B=B-b.offsetHeight-e.bottomOffset-50}else{l="0.4s";i="0";B=B-50}break;default:l="0.8s";i="0"}b.addEventListener("webkitTransitionEnd",h,false);b.style.opacity=i;b.style.webkitTransitionDuration=l;b.style.webkitTransform="translate3d("+C+"px,"+B+"px,0)"}window.addToHomeClose=c})();